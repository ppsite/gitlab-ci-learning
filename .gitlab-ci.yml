# 默认执行顺序
stages:
  - .pre
  - build
  - test
  - deploy

  # build packs
build_win:
  stage: build
  script:
    - sleep 10
    - touch ./build/win.txt
    - echo "Build Windows Packs"

build_linux:
  stage: build
  script:
    - touch ./build/linux.txt
    - echo "Build Linux Packs"

build_mac:
  stage: build
  script:
    - touch ./build/mac.txt
    - echo "Build Mac Packs"

# test packs
test_win:
  stage: test
  needs:
    - build_win
  artifacts:
    paths:
      - ./build/
    exclude:
      - .gitkeep
    expire_in: 1 days
  script:
    - sleep 10
    - echo "Test Windows Packs"

test_linux:
  stage: test
  artifacts:
    paths:
      - ./build/
    exclude:
      - .gitkeep
    expire_in: 1 days
  needs:
    - build_linux
  script:
    - echo "Test Linux Packs"

test_mac:
  stage: test
  needs:
    - build_mac
  artifacts:
    paths:
      - ./build/
    exclude:
      - .gitkeep
    expire_in: 1 days
  script:
    - echo "Test Mac Packs"

# deploy packs
deploy_win:
  stage: deploy
  needs:
    - test_win
  dependencies:
    - build_win
  script:
    - echo "Deploy Windows Packs"

deploy_linux:
  stage: deploy
  needs:
    - test_linux
  dependencies:
    - build_linux
  script:
    - echo "Deploy Linux Packs"

deploy_mac:
  stage: deploy
  needs:
    - test_mac
  dependencies: []    # 空列表代表不下载任何制品
  script:
    - echo "Deploy Mac Packs"